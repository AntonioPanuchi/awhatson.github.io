# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è–º–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ **Solobot**

## 1. –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–ú–æ–¥—É–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ **Solobot** –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–∏ –¥–æ—Å—Ç—É–ø–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–æ–¥—É–ª—è.

---

## 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è

–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É **¬´–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É¬ª**.

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ø–æ—è–≤–∏—Ç—Å—è —Ä–∞–∑–¥–µ–ª **¬´–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è–º–∏¬ª**.

---

## 3. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–¥–µ–ª–∞ ¬´–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è–º–∏¬ª

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–∂–µ—Ç:

* –£–∫–∞–∑—ã–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è.
* –ó–∞–¥–∞–≤–∞—Ç—å –Ω–æ–º–µ—Ä –≤–µ—Ä—Å–∏–∏.
* –ó–∞–≥—Ä—É–∂–∞—Ç—å –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å.
* –û–±–Ω–æ–≤–ª—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å.
* –ü—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–¥—É–ª—è.

---

## 4. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥—É–ª—è–º–∏

* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–¥—É–ª—è ‚Äî —Ñ–æ—Ä–º–∞—Ç **16:9**.
* –í—ã–¥–∞—á–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.

---

## 5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é

* –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –æ–ø–∏—Å–∞–Ω–∏—è –º–æ–¥—É–ª—è.
* –°–ª–µ–¥–∏—Ç–µ –∑–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å—é –Ω–æ–º–µ—Ä–∞ –≤–µ—Ä—Å–∏–∏.
* –ü–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥—É–ª—å –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –º–æ–¥—É–ª–µ–π –¥–ª—è **Solo\_bot**

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–æ–¥—É–ª–∏ –¥–ª—è –±–æ—Ç–∞, –≤–∫–ª—é—á–∞—è:

* —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤,
* —Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (—Ö—É–∫–∏),
* –ø—Ä–æ—Ç–æ–∫–æ–ª –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫,
* –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è,
* –±—ã—Å—Ç—Ä—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–ø–ª–∞—Ç—ã,
* –≤–µ–±—Ö—É–∫–∏ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.

---

### –¶–µ–ª–∏ –º–æ–¥—É–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã:

* **–ò–∑–æ–ª—è—Ü–∏—è** ‚Äî –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–∞–ø–∫–µ `modules/<module_name>/`, —Ç–µ–∫—Å—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è.
* **–ü–æ–¥–∫–ª—é—á–∞–µ–º–æ—Å—Ç—å** ‚Äî –º–æ–¥—É–ª—å –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ `router.py` –æ–Ω —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `router`.
* **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å UI** ‚Äî —Å –ø–æ–º–æ—â—å—é —Ö—É–∫–æ–≤ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–µ–Ω—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —è–¥—Ä–µ.
* **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –æ—à–∏–±–∫–∏ –º–æ–¥—É–ª—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –Ω–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

---

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤):

```
modules/
 my_module/
   __init__.py          # —ç–∫—Å–ø–æ—Ä—Ç router (–∏/–∏–ª–∏ –¥—Ä—É–≥–∏–µ –ø—É–±–ª–∏—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã)
   router.py            # –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥: aiogram Router, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö—É–∫–æ–≤
   texts.py             # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã –º–æ–¥—É–ª—è
   settings.py          # –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è (–≤ —Ç.—á. —Ñ–ª–∞–≥–∏ –≤–∫–ª/–≤—ã–∫–ª)
   models.py            # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –º–æ–¥–µ–ª–∏ SQLAlchemy
   db.py                # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) DAO-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏
```

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

* —Ö—Ä–∞–Ω–∏—Ç–µ –≤—Å–µ —Ç–µ–∫—Å—Ç—ã, –∫–Ω–æ–ø–∫–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `texts.py`);
* –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–º–µ—â–∞–π—Ç–µ –≤ `settings.py`;
* –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö.

---

### –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ `__init__.py`:

```python
__all__ = ("router",)
from .router import router
# –í–ê–ñ–ù–û: —á—Ç–æ–±—ã —Ç–∞–±–ª–∏—Ü—ã –º–æ–¥—É–ª—è –ø–æ–ø–∞–ª–∏ –≤ metadata –∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ init_db,
# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥—É–ª—è
from . import models  # noqa: F401
```

---

### –ü—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã –ë–î (`models.py`):

```python
from datetime import datetime
from sqlalchemy import BigInteger, Column, DateTime, ForeignKey, String
from database.models import Base

class ChannelBonusClaim(Base):
   __tablename__ = "channel_bonus_claims"

   tg_id = Column(BigInteger, ForeignKey("users.tg_id", ondelete="CASCADE"), primary_key=True)
   claimed_at = Column(DateTime, default=datetime.utcnow)
```

---

### DAO (`db.py`):

```python
from sqlalchemy import select
from sqlalchemy.dialects.postgresql import insert
from sqlalchemy.ext.asyncio import AsyncSession
from .models import ChannelBonusClaim

async def has_claim(session: AsyncSession, tg_id: int) -> bool:
   res = await session.execute(select(ChannelBonusClaim).where(ChannelBonusClaim.tg_id == tg_id))
   return res.scalar_one_or_none() is not None

async def set_claim(session: AsyncSession, tg_id: int):
   stmt = (
       insert(ChannelBonusClaim)
       .values(tg_id=tg_id)
       .on_conflict_do_nothing(index_elements=[ChannelBonusClaim.tg_id])
   )
   await session.execute(stmt)
   await session.commit()
```

---

### –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π

* `load_modules_from_folder()` ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ `router`
* `load_module_webhooks()` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–µ–±—Ö—É–∫–æ–≤
* `load_module_fast_flow_handlers()` ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –æ–ø–ª–∞—Ç—ã

---

### –•—É–∫–∏ (—Ç–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)

–ü—Ä–∏–º–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:

```python
from aiogram.types import InlineKeyboardButton
from aiogram.utils.keyboard import InlineKeyboardBuilder
from hooks.hooks import register_hook

def _build_button():
   return InlineKeyboardButton(text="–ú–æ—è –∫–Ω–æ–ø–∫–∞", callback_data="my_module|open")

async def profile_menu_hook(**kwargs):
   return {"after": "balance", "button": _build_button()}

register_hook("profile_menu", profile_menu_hook)
```

---

### –ü—Ä–∏–º–µ—Ä—ã –≤—Å—Ç–∞–≤–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫

1. –£–±—Ä–∞—Ç—å –∫–Ω–æ–ø–∫—É TV –∏ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é:

```python
return [
 {"remove": f"connect_tv|{key_name}"},
 {"button": InlineKeyboardButton(text="üì∫ Happ TV", callback_data=f"happ_tv|{key_name}")},
]
```

2. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ ¬´balance¬ª:

```python
return {"after": "balance", "button": InlineKeyboardButton(text="üèÜ –¢–æ–ø", callback_data="top_referrers")}
```

3. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–Ω–æ–ø–∫–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º:

```python
return {"remove_prefix": "legacy_"}
```

---

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```python
from hooks.hooks import register_hook

async def periodic_notify(bot, session, keys, **kwargs):
   pass

register_hook("periodic_notifications", periodic_notify)
```

---

### ¬´–ë—ã—Å—Ç—Ä—ã–π —Ñ–ª–æ—É¬ª –æ–ø–ª–∞—Ç—ã

```python
def get_fast_flow_handler():
   return {
       "payment_key": "my_flow",
       "handler": my_flow_handler,
   }
```

---

### –í–µ–±—Ö—É–∫–∏

```python
def get_webhook_data():
   return {
       "path": "/api/my_module",
       "handler": my_webhook_handler
   }
```

---

### –ü—Ä–∏–º–µ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –º–æ–¥—É–ª—è —Å –∫–Ω–æ–ø–∫–æ–π

```python
# modules/hello_world/router.py
from aiogram import Router, F
from aiogram.types import CallbackQuery, InlineKeyboardButton
from aiogram.utils.keyboard import InlineKeyboardBuilder
from hooks.hooks import register_hook

router = Router()

def _btn():
   return InlineKeyboardButton(text="üëã –ü—Ä–∏–≤–µ—Ç", callback_data="hello|open")

async def profile_menu_hook(**kwargs):
   return {"after": "balance", "button": _btn()}

register_hook("profile_menu", profile_menu_hook)

@router.callback_query(F.data == "hello|open")
async def open_hello(callback: CallbackQuery):
   kb = InlineKeyboardBuilder()
   kb.row(InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="profile"))
   await callback.message.edit_text("–ü—Ä–∏–≤–µ—Ç –∏–∑ –º–æ–¥—É–ª—è!", reply_markup=kb.as_markup())
```

---

### –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –º–æ–¥—É–ª—è:

* –ï—Å—Ç—å `router`, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–∑ `__init__.py`.
* –í—Å–µ —Ç–µ–∫—Å—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `texts.py`, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî –≤ `settings.py`.
* –•—É–∫–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ `register_hook`.
* FSM –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–∞—Ö –∏ –æ—à–∏–±–∫–∞—Ö.
* –ö–Ω–æ–ø–∫–∏ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª –æ–ø–µ—Ä–∞—Ü–∏–π.
* –°–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫.
* –î–∞—Ç—ã –∏ –≤—Ä–µ–º—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã —Å —Ç–∏–ø–∞–º–∏ –ë–î.

---
